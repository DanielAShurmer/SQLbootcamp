
select name as Most_Popular_Product 
from products 
where PId = (
	select PId from (
		select PId, count(*) as Total_Sales 
		from sales group by PId 
		order by Total_Sales desc) 
		where Total_Sales = (
			select max(Total_Sales) 
			from (
				select PId, count(*) as Total_Sales 
				from sales 
				group by PId 
				order by Total_Sales desc)
			)
		)
;

select sid,count(*) from (select name,qty,sid from sales,products where sales.pid=products.pid) group by sid;

 select description,count(*) from
 (select * from sales,products,subcategory where sales.PId = Products.PId and products.SId = Subcategory.SId)
 group by description;

select description from
(select description,count(*) as Products_Sold_In_Subcat from
(select * from sales,products,subcategory where sales.PId = Products.PId and products.SId = Subcategory.SId)
group by description order by count(*) desc)
where Products_Sold_In_Subcat =
(select max(Products_Sold_In_Subcat) from
(select description,count(*) as Products_Sold_In_Subcat from
(select * from sales,products,subcategory where sales.PId = Products.PId and products.SId = Subcategory.SId)
group by description order by count(*) desc)
);

select description from
(select category.description,count(*) as Products_Sold_In_Cat from sales,products,subcategory,category
where sales.PId = Products.PId and products.SId = Subcategory.SId and subcategory.CId = category.cid 
group by category.description order by count(*) desc)
where products_sold_in_cat = (
select max(products_sold_in_cat) from (
select category.description,count(*) as Products_Sold_In_Cat from sales,products,subcategory,category
where sales.PId = Products.PId and products.SId = Subcategory.SId and subcategory.CId = category.cid 
group by category.description order by count(*) desc
));



